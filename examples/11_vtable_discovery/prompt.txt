# Exercise 11: Vtable Discovery + Class Layout Approximation
Category: C. Function Boundary, Signature, Types, and ABI Reality Checks

## Binary
input.i64

## Binary Requirements
- C++ binary with virtual classes:
  - Multiple classes with virtual methods
  - Inheritance hierarchy (base + derived)
  - RTTI present (preferred) or stripped
  - Vtables in .rodata section
- Class characteristics:
  - Virtual destructors
  - Pure virtual methods (if abstract bases)
  - Multiple inheritance cases (bonus complexity)
- At least 5-8 classes with vtables

## Task
Automatically locate C++ vtables and reconstruct class information:
1. Locate vtables:
   - Scan .rodata for pointer arrays
   - Validate entries point to code
   - Check for RTTI pointer prefix (if present)

2. Identify virtual methods:
   - Extract method pointers from vtable
   - Determine slot count
   - Handle pure virtual placeholders

3. Group into classes:
   - Use RTTI if available
   - Otherwise use construction patterns
   - Detect inheritance by vtable prefix similarity

4. Create class-like structs:
   - vptr as first member
   - Method slot names
   - Size estimation from constructors

Bonus: Detect inheritance relationships

## Expected Output
- List of discovered vtables with:
  - Vtable EA
  - Class name (from RTTI or generated)
  - Method list with EAs and names
  - Inheritance relationships (if detected)
- Generated struct types in IDA
- Method renaming (Class::method pattern)

## Expected Class of Solution
- Vtable pattern scanning
- RTTI parsing (if available):
  - type_info structure
  - class hierarchy info
- Constructor/destructor analysis for:
  - vptr assignment patterns
  - Object size inference
- Struct generation via IDA APIs
- Inheritance detection via vtable comparison

## Evaluation Criteria
- Vtable detection completeness
- Class reconstruction accuracy
- Inheritance relationship correctness
- Quality of generated names/structs
