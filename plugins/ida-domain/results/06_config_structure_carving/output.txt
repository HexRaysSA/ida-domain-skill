[94mInfo:[0m Executing wrapped file: /tmp/ida-domain-ex06.py...
======================================================================
Configuration Structure Carving Analysis
======================================================================

[1] Searching for configuration blob...
    Found 'CFG' magic at 1 location(s):
    - 0x10002A370

    Config blob identified at: 0x10002A370

[2] Reading configuration data...
    Magic: b'CFG\x00'

[3] Parsing configuration fields...
    Version: 2.5
    Config size: 676 bytes
    Feature flags: 0x80030501

    Primary Server:
      IP: 192.168.1.100
      Port: 8443
      Timeout: 30000ms
      Retry count: 3
      Flags: 0x05

    Backup Server:
      IP: 10.0.0.50
      Port: 443
      Timeout: 60000ms
      Retry count: 5
      Flags: 0x07

    URLs:
      Callback: https://api.example-c2.net/beacon/v2/callback
      Update: https://updates.example-c2.net/agent/update

    Paths:
      Install: /var/lib/.hidden/agent
      Log: /tmp/.cache/agent.log

    Credentials:
      Username: agent_service_user
      Password hash: 5e884898da28047151d0e56f8dc62927...
      API key: sk-live-a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0
      Token expiry: 1735689600 (Unix timestamp)

    Timing:
      Beacon interval: 300 seconds (5.0 minutes)
      Jitter: 20%
      Sleep on error: 3600 seconds

    IP Whitelist:
      [0]: 10.0.0.1
      [1]: 10.0.0.2
      [2]: 192.168.1.1
      [3]: 192.168.1.254
      [4]: 172.16.0.1

    Encryption Key:
      First 16 bytes: 7a3f9c2e81d547b9f36a1c8e52cd0ba4
      Entropy: 6.00 bits (high entropy indicates encrypted/random data)

    Checksum: 0xDEADBEEF
    End padding: 0xaabbccdd

[4] Generating IDA struct definition...

    // Auto-generated configuration structure from binary analysis
    // Base address: 0x10002A370

    typedef struct {
        uint8_t ip_addr[4];        // IPv4 address
        uint16_t port;             // Port number
        uint32_t timeout_ms;       // Connection timeout (ms)
        uint8_t retry_count;       // Max retries
        uint8_t flags;             // Connection flags
        uint8_t _padding[2];       // Alignment padding
    } ServerEndpoint;             // size: 14 bytes

    typedef struct {
        char username[32];         // Null-terminated username
        uint8_t password_hash[32]; // SHA-256 hash
        char api_key[64];          // API key string
        uint64_t token_expiry;     // Unix timestamp
    } CredentialBlock;            // size: 136 bytes

    typedef struct {
        char magic[4];             // "CFG\0" - offset 0x000
        uint16_t version_major;    // offset 0x004
        uint16_t version_minor;    // offset 0x006
        uint32_t config_size;      // Total size - offset 0x008
        uint32_t feature_flags;    // Feature bits - offset 0x00C
        ServerEndpoint primary_server;  // offset 0x010
        ServerEndpoint backup_server;   // offset 0x01E
        char callback_url[128];    // C2 callback URL - offset 0x02C
        char update_url[128];      // Update URL - offset 0x0AC
        char install_path[64];     // Installation path - offset 0x12C
        char log_path[64];         // Log file path - offset 0x16C
        CredentialBlock credentials;    // offset 0x1AC
        uint32_t beacon_interval_sec;   // Beacon timing - offset 0x234
        uint16_t jitter_percent;   // Timing jitter - offset 0x238
        uint16_t sleep_on_error_sec;    // Error sleep - offset 0x23A
        uint8_t ip_whitelist[8][4];     // 8 IPv4 addresses - offset 0x23C
        uint8_t encryption_key[64];     // High-entropy key - offset 0x25C
        uint32_t config_checksum;  // CRC/checksum - offset 0x29C
        uint8_t _end_padding[4];   // End marker - offset 0x2A0
    } ConfigBlob;                 // Total size: 676 bytes
    

======================================================================
Configuration Structure Carving Summary
======================================================================

    CONFIG BLOB LOCATION: 0x10002A370
    CONFIG SIZE: 676 bytes

    DECODED VALUES:
    ---------------
    Version: 2.5
    Feature Flags: 0x80030501

    Primary C2 Server:
      Address: 192.168.1.100:8443
      Timeout: 30000ms
      Retries: 3

    Backup C2 Server:
      Address: 10.0.0.50:443
      Timeout: 60000ms
      Retries: 5

    URLs:
      Callback: https://api.example-c2.net/beacon/v2/callback
      Update: https://updates.example-c2.net/agent/update

    Paths:
      Install: /var/lib/.hidden/agent
      Log: /tmp/.cache/agent.log

    Credentials:
      Username: agent_service_user
      API Key: sk-live-a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0
      Token Expiry: 1735689600

    Timing:
      Beacon: 300s (5.0 min)
      Jitter: 20%
      Sleep on Error: 3600s

    IP Whitelist: 10.0.0.1, 10.0.0.2, 192.168.1.1, 192.168.1.254, 172.16.0.1

    Encryption Key Entropy: 6.00 bits
    Config Checksum: 0xDEADBEEF
    

FIELD TABLE:
----------------------------------------------------------------------
Field Name                     Type            Offset   Value
----------------------------------------------------------------------
magic                          char[4]         0x0000   CFG
version_major                  uint16_t        0x0004   2
version_minor                  uint16_t        0x0006   5
config_size                    uint32_t        0x0008   676
feature_flags                  uint32_t        0x000C   0x80030501
primary_server.ip_addr         uint8_t[4]      0x0010   192.168.1.100
primary_server.port            uint16_t        0x0014   8443
primary_server.timeout_ms      uint32_t        0x0016   30000
primary_server.retry_count     uint8_t         0x001A   3
primary_server.flags           uint8_t         0x001B   0x05
backup_server.ip_addr          uint8_t[4]      0x001E   10.0.0.50
backup_server.port             uint16_t        0x0022   443
backup_server.timeout_ms       uint32_t        0x0024   60000
backup_server.retry_count      uint8_t         0x0028   5
backup_server.flags            uint8_t         0x0029   0x07
callback_url                   char[128]       0x002C   https://api.example-c2.net/beacon/v2/...
update_url                     char[128]       0x00AC   https://updates.example-c2.net/agent/...
install_path                   char[64]        0x012C   /var/lib/.hidden/agent
log_path                       char[64]        0x016C   /tmp/.cache/agent.log
credentials.username           char[32]        0x01AC   agent_service_user
credentials.password_hash      uint8_t[32]     0x01CC   5e884898da28047151d0e56f8dc62927...
credentials.api_key            char[64]        0x01EC   sk-live-a1b2c3d4e5f6g7h8i9j0k1l2m3n4o...
credentials.token_expiry       uint64_t        0x022C   1735689600
beacon_interval_sec            uint32_t        0x0234   300
jitter_percent                 uint16_t        0x0238   20
sleep_on_error_sec             uint16_t        0x023A   3600
ip_whitelist                   uint8_t[8][4]   0x023C   ['10.0.0.1', '10.0.0.2', '192.168.1.1...
encryption_key                 uint8_t[64]     0x025C   [6.00 bits entropy]
config_checksum                uint32_t        0x029C   0xDEADBEEF
_end_padding                   uint8_t[4]      0x02A0   aabbccdd
======================================================================
Analysis complete.
